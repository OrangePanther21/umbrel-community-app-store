version: "3.7"

services:
  app_proxy:
    environment:
      APP_HOST: robosats-tools-robosats-notifier_web_1
      APP_PORT: 12597
  
  web:
    image: orangepanther21/robosats-notifier:latest
    restart: on-failure
    stop_grace_period: 1m
    command: sh -c "rm -f /app/.wwebjs_auth/*/SingletonLock /app/.wwebjs_auth/*/SingletonSocket /app/.wwebjs_auth/*/SingletonCookie 2>/dev/null || true && exec node src/index.js"
    volumes:
      - ${APP_DATA_DIR}/data:/data
      - ${APP_DATA_DIR}/auth:/app/.wwebjs_auth
    environment:
      WHATSAPP_GROUP_NAME: ""
      CHECK_INTERVAL_MINUTES: "5"
      TARGET_CURRENCIES: ""
      LANGUAGE: "EN"
      BOT_ENABLED: "true"
      ROBOSATS_API_URL: "http://robosats_web_1:12596"
      ROBOSATS_COORDINATORS: "temple,moon,lake"
      ROBOSATS_ONION_URL: "http://robosatsy56bwqn56qyadmcxkx767hnabg4mihxlmgyt6if5gnuxvzad.onion"
      CONFIG_FILE: "/data/config.json"
      WEB_PORT: "12597"
      LOG_LEVEL: "info"
